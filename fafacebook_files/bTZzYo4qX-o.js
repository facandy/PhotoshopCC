/*!CK:2941441149!*//*1446435691,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["LfzUa"]); }

__d('ReactComposerPhotoLegacyLimitExceededDialog',['Dialog','fbt'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={show:function(k){var l=i._("Too Many Photos"),m=i._("Sorry, you can only add {maxselect} photos to a message. If you'd like, you can add photos to additional messages.",[i.param('maxselect',k)]);new h().setTitle(l).setBody(m).setButtons(h.OK).setModal(true).show();}};f.exports=j;},null);
__d('ReactComposerVideoLegacyLimitExceededDialog',['ErrorDialog','fbt'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={show:function(){h.show(i._("Too many files"),i._("Please select only one video file at a time."));}};f.exports=j;},null);
__d('ReactComposerVideoUploadActions',['ReactComposerDispatcher','ReactComposerVideoUploadActionType','ReactComposerVideoUploadStore'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();c('ReactComposerVideoUploadStore');var j={setUploader:function(k,l){h.dispatch({composerID:k,type:i.VIDEO_SET_UPLOADER,uploader:l});},add:function(k,l){h.dispatch({composerID:k,type:i.VIDEO_UPLOAD_ADD,file:l});},remove:function(k){h.dispatch({composerID:k,type:i.VIDEO_UPLOAD_REMOVE});}};f.exports=j;},null);
__d('ReactComposerMediaUtils',['ComposerXNativeAudioUploadsConfig','ReactComposerPhotoActions','ReactComposerPhotoLegacyLimitExceededDialog','ReactComposerPhotoUploadActions','ReactComposerPhotoUploadStore','ReactComposerVideoLegacyLimitExceededDialog','ReactComposerVideoUploadStore','ReactComposerVideoUploadActions','VideoUploadFeatureDetector','VideoUploadConfig','VideoUploadFile','Map','PUWMethods','uniqueID'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){if(c.__markCompiled)c.__markCompiled();var v={clearInput:function(w){var x=this.getFileNamesFromFileInput(w.getInput());if(!v.hasVideos(x))w.clear();},getFileNames:function(w){var x=[];for(var y=0;y<w.length;y++)x.push(w[y].name);return x;},getFileNamesFromFileInput:function(w){if(p.supportsFileAPI()){return this.getFileNames(w.files);}else return [w.value.split('/').pop().split('\\').pop()];},hasVideos:function(w){if(q.allowMultimedia)return false;return this.filterVideos(w).length>0;},hasAudioFiles:function(w){return this.filterAudioFiles(w).length>0;},filterVideos:function(w){return this.filterFileOfSupportedType(w,q.videoExtensions);},filterAudioFiles:function(w){return this.filterFileOfSupportedType(w,h.audioExtensions);},filterFileOfSupportedType:function(w,x){return w.filter(function(y){var z=y.indexOf('.')!==-1?y.split('.').pop().toLowerCase():'';return x[z];});},uploadVideo:function(w,x){if(l.getUploads(w).size>0)k.removeAllPhotoUploads(w);o.add(w,x);},uploadPhotos:function(w,x,y,z,aa,ba){var ca=y.isUploadLimitExceeded(z,x);if(ca){j.show(y.getMaxSelectableFilesCount(z));return;}var da=x?x.length:1;if(da<1)return;if(n.getVideo(w))o.remove(w);k.photosSelect(w,da,aa);ba&&ba();},uploadPhotosOrVideoFromTarget:function(w,x,y,z){var aa=this.getFileNamesFromFileInput(x);if(this.hasVideos(aa)){if(x.files&&x.files.length>1){m.show();}else this.uploadVideo(w,r.fromFileInput(x));}else this.uploadPhotos(w,x.files,y,z,t.FILE_SELECTOR,function(){y&&y.upload(x);});},uploadPhotosOrVideo:function(w,x,y,z){var aa=arguments.length<=4||arguments[4]===undefined?t.FILE_SELECTOR:arguments[4],ba=this.getFileNames(x);if(this.hasVideos(ba)){if(x&&x.length>1){m.show();}else this.uploadVideo(w,r.fromFile(x[0]));}else this.uploadPhotos(w,x,y,z,aa,function(){x.forEach(function(ca){ca.uploadID=u();ca.filename='';});y.enqueueAsyncUploadRequest(w,x,{});});},onImageEdited:function(w,x,y,z){var aa=l.getUploads(w),ba=aa.find(function(fa){return (fa.photoID===z.fbid||fa.originalPhotoID===z.fbid);}),ca=l.getUploadIndex(w,ba.id);i.removePhoto(w,ba.photoID,ba.id);var da=z.blob;da.uploadID=u();da.filename=ba.filename;var ea=new s([[da.uploadID,ca]]);x&&x.enqueueAsyncUploadRequest(w,[da],{data:{original_fbid:z.fbid},indexMap:ea});k.photosSelect(w,1,t.METHOD_EDITOR);i.finishPhotoEdit(w);}};f.exports=v;},null);